
  // Inject theme assets across all pages
  (function ensureThemeAssets(){
    if (!document.querySelector('link[href$="theme.css"]')) {
      const link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = 'theme.css';
      document.head.appendChild(link);
    }
    if (!document.querySelector('script[src$="theme.js"]')) {
      const s = document.createElement('script');
      s.src = 'theme.js';
      s.defer = true;
      document.head.appendChild(s);
    }
  })();

  // Add Super Admin link if user is super_admin (after header loads)
  (async function addSuperAdminLink(){
    try{
      const r = await fetch('api/auth/profile.php',{credentials:'include', cache:'no-store'});
      const me = await r.json();
      if (me && me.role === 'super_admin') {
        const nav = document.querySelector('nav, .nav, header'); // best-effort
        if (nav && !document.querySelector('a[href="superadmin/users.html"]')) {
          const a = document.createElement('a');
          a.href = 'superadmin/users.html';
          a.textContent = 'Users';
          a.style.marginLeft = '12px';
          nav.appendChild(a);
        }
      }
    }catch{}
  })();

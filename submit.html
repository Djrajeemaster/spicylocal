
<!DOCTYPE html>
<html lang="en">
<body>
 <div id="global-header"></div>
<link rel="stylesheet" href="header.css">
<script src="loadHeader.js" defer></script>
  <main class="form-container">
    <h2>Submit a New Deal</h2>
    <form id="deal-form">
      <input type="text" id="title" placeholder="Deal Title" required><br>
      <textarea id="description" placeholder="Deal Description" required></textarea><br>
      <select id="category">
        <option value="">Select Category</option>
        <option value="Food">Food</option>
        <option value="Clothing">Clothing</option>
        <option value="Travel">Travel</option>
        <option value="Entertainment">Entertainment</option>
        <option value="Fuel">Fuel</option>
      </select><br>
      <input type="text" id="image" placeholder="Image URL (optional)"><br>
      <button type="submit">Submit Deal</button>
    </form>
    <p id="message"></p>
  </main>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("deal-form");
      const msg = document.getElementById("message");
      const username = localStorage.getItem("username");
      if (!username) return window.location.href = "login.html";

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const payload = {
          username,
          title: document.getElementById("title").value,
          description: document.getElementById("description").value,
          category: document.getElementById("category").value,
          image: document.getElementById("image").value
        };

        const res = await fetch("api/submit_deal.php", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
        const data = await res.json();
        if (data.success) {
          msg.textContent = "✅ Deal submitted successfully! Awaiting approval.";
          form.reset();
        } else {
          msg.textContent = "❌ Submission failed: " + data.error;
        }
      });
    });
  </script>
<script src="footer.js"></script>
</body>
</html>
